"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const discord_js_1 = require("discord.js");
const throwError_1 = require("./throwError");
exports.checkPermissions = (config, guild) => {
    if (guild === null) {
        // In a DM or groupDM.
        // TODO: Figure out what permissions we have in a DM channel.
        // tslint:disable-next-line:no-console
        console.warn(`DynamicMessage - Unable to resole permissions of "null" guild. Continuing may result in unintended behavior.`);
        return;
    }
    return [
        discord_js_1.Permissions.FLAGS.VIEW_CHANNEL,
        discord_js_1.Permissions.FLAGS.ADD_REACTIONS,
        discord_js_1.Permissions.FLAGS.MANAGE_MESSAGES,
        discord_js_1.Permissions.FLAGS.SEND_MESSAGES,
        discord_js_1.Permissions.FLAGS.READ_MESSAGE_HISTORY,
    ].forEach((permission) => {
        const gotPermissions = guild.me.hasPermission(permission);
        if (!gotPermissions) {
            throwError_1.throwError(config, `DynamicMessage - Missing permission ${permission.toString()}`);
        }
    });
};
